# Migration `20200202113550-updated-apps`

This migration has been generated by SeanCottrill at 2/2/2020, 11:35:50 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "lift"."new_Application" (
  "applicationDate" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "applicationID" TEXT NOT NULL   ,
  "program" TEXT    REFERENCES "Program"(id) ON DELETE SET NULL,
  "programID" TEXT NOT NULL DEFAULT ''  ,
  "status" TEXT NOT NULL DEFAULT 'pending'  ,
  "user" TEXT    REFERENCES "User"(id) ON DELETE SET NULL,
  "userID" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("applicationID")
);

INSERT INTO "new_Application" ("applicationDate","program","status","user") SELECT "applicationDate","program","status","user" from "Application"

DROP TABLE "lift"."Application";

ALTER TABLE "lift"."new_Application" RENAME TO "Application";

PRAGMA "lift".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration 20200116185516-progs-apps-users..20200202113550-updated-apps
--- datamodel.dml
+++ datamodel.dml
@@ -1,14 +1,14 @@
 datasource sqlite {
   provider = "sqlite"
-  url = "***"
+  url      = "file:dev.db"
   enabled  = true
 }
 // This is used in prod
 // datasource db {
 //   provider = "mysql"
-     url = "***"
+//   url      = env("MYSQL_URL")
 //   default  = true
 // }
 generator photon {
@@ -84,9 +84,10 @@
   applications            Application[]
 }
 model Application {
-  id                  String               @default(cuid()) @id
-  program             Program     
+  applicationID       String               @default(cuid()) @id
+  userID              String
+  programID           String
   status              ApplicationStatus 
   applicationDate     DateTime             @default(now())
 }
```

## Photon Usage

You can use a specific Photon built for this migration (20200202113550-updated-apps)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20200202113550-updated-apps'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
